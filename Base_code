import requests
from bs4 import BeautifulSoup

BASE_URL = 'https://books.toscrape.com/'

def get_soup(url):
    res = requests.get(url)
    return BeautifulSoup(res.text, 'html.parser')

def get_categories():
    soup = get_soup(BASE_URL)
    category_section = soup.find('div', class_='side_categories')
    links = category_section.find_all('a')[1:]
    categories = {i+1: (link.text.strip(), BASE_URL + link['href']) for i, link in enumerate(links)}
    return categories

def search_by_category():
    categories = get_categories()
    print("\nPieejamās kategorijas:")
    for i, (name, _) in categories.items():
        print(f"{i}. {name}")
    try:
        selected = int(input("\nIzvēlieties kategorijas numuru: ").strip())
        name, url = categories.get(selected, (None, None))
        if not name:
            print("Nederīgs numurs.")
            return
        print(f"\nGrāmatas kategorijā '{name}':")
        soup = get_soup(url)
        books = soup.find_all('article', class_='product_pod')
        for book in books:
            title = book.h3.a['title']
            print(f" - {title}")
    except ValueError:
        print("Ievadiet ciparu.")

def main():
    while True:
        print("\nMetodes:")
        print("1. Kategorijas")
        print("2. Beigt darbu")
        choice = input("Izvēlieties darbību (1-2): ").strip()

        if choice == '1':
            search_by_category()
        elif choice == '2':
            print("Darbs pārtraukts.")
            break
        else:
            print("Nederīga izvēle.")

if __name__ == "__main__":
    main()
